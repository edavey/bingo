#!/usr/bin/env ruby -wU

require 'highline'
require 'pry'
require_relative './balls'

def all_done
  puts "No more balls. That's it!"
end

def game_ended
  puts "Game finished."
end

def number(int)
  "<%= color('#{int}', :yellow) %>"
end

def nickname(str)
  %{<%= color("#{str}", :bright_blue) %>}
end

cli = HighLine.new

number_of_balls = cli.ask("How many balls in this game?", Integer)
bag = BALLS[0..(number_of_balls - 1)]

cli.say "We are starting a game of <%= color('#{bag.size}', BOLD) %> balls."

loop do
  response = cli.ask('Hit RETURN for the next number or type FINISH (or q) to stop playing.')

  break game_ended if response.upcase == 'FINISH' || response.upcase == 'Q'
  break all_done if bag.empty?
  ball = bag.delete(bag.sample)
  puts
  cli.say("<#{nickname(ball[:nickname])}>")
  puts
  cli.say("  -> number #{number(ball[:number])}")
  puts
  cli.say(''.ljust(5) + "(#{ball[:notes]})")
  puts
  puts '-------'
  puts
end
